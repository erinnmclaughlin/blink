@page "/account/login"
@layout Blink.WebApp.Components.Layout.EmptyLayout

@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Identity
@using Blink.WebApp.Data

<PageTitle>Sign in</PageTitle>

<div class="page">

    <h2 class="page-title">Sign in to your account</h2>

    <Paper>
        <div class="paper-content">
            <EditForm Model="Input" method="post" OnValidSubmit="LoginUser" FormName="login">

                <DataAnnotationsValidator />

                <BlinkFormField FieldId="Input.Email" Label="Email address">
                    <BlinkInputText @bind-Value="Input.Email" autocomplete="username" aria-required="true" placeholder="name@example.com" type="email" />
                </BlinkFormField>

                <BlinkFormField FieldId="Input.Password" Label="Password">
                    <BlinkInputText @bind-Value="Input.Password" autocomplete="current-password" aria-required="true" placeholder="password" type="password" />
                </BlinkFormField>

                <div class="flex space-between">
                    <BlinkFormField FieldId="Input.RememberMe" Label="Remember me">
                        <BlinkInputCheckbox @bind-Checked="Input.RememberMe" />
                    </BlinkFormField>
                    <div>
                        <a class="bold" style="font-size: 0.875rem;" href="Account/ForgotPassword">Forgot password?</a>
                    </div>
                </div>

                <div>
                    <BlinkButton ButtonTheme="BlinkButtonTheme.Primary" ButtonType="BlinkButtonType.Submit" Id="loginButton">Sign in</BlinkButton>
                </div>
            </EditForm>
            <section id="socialLogins">

                <BlinkDivider Text="Or continue with" />

                <form action="account/performExternalLogin" method="post" style="margin-top: 1.5rem;">
                    <div>
                        <AntiforgeryToken />
                        <input type="hidden" name="ReturnUrl" value="@ReturnUrl" />
                        <p>
                            <BlinkButton ButtonType="BlinkButtonType.Submit" 
                                         ClassNames="external-login-button"
                                         Name="provider"
                                         Title="Sign in using your Microsoft account"
                                         Value="Microsoft">
                                <MicrosoftLogo />
                                <span>Microsoft</span>
                            </BlinkButton>
                        </p>
                    </div>
                </form>
            </section>
        </div>
    </Paper>
</div>
